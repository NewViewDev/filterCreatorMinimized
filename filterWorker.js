function findColorIndx(e,a,t,n,o){let r=4*a[0],l=4*a[1]*t,i=0;switch(o){case"r":break;case"g":i=1;break;case"b":i=2;break;case"a":i=3}if(!(l+e<0||l+e>=n||r+e<0||r+e>=n))return e+l+r+i}importScripts("./mathjs/lib/browser/math.js"),onmessage=function(e){let a=e.data[0],t=e.data[1],n=(e.data[2],e.data[3]),o=e.data[4],r=e.data[4],l=e.data[5],i=a.length,s=new ArrayBuffer(l-r),d=new Uint8ClampedArray(s),f=new Uint32Array(s);f[1]=168496141;var c=!0;10===s[4]&&11===s[5]&&12===s[6]&&13===s[7]&&(LittleEndian=!1);let u=3,b="0";function g(e){let o=[0,0,0,a[e+3]];for(let r=0;r<u;++r){let l="";for(let o of t[r]){let t=o.type;if("square"===t){let t=findColorIndx(e,o.loc,n,i,o.color);void 0===a[t]?(console.log("Undefined pixel location: "+t),l+=b):l+=a[t]}"sign"!==t&&"value"!==t||(l+=o.info)}o[r]=math.evaluate(l)}f[(e-r)/4]=c?o[3]<<24|o[2]<<16|o[1]<<8|o[0]:o[0]<<24|o[1]<<16|o[2]<<8|o[3]}for(;o<l;)g(o),o+=4;postMessage([d,r]),close()};
